<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>–ö–∞—Ç–∞–ª–æ–≥ - –°—Ç—Ä–æ–π–ú–∞–≥</title>
  <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üß±</text></svg>">
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="style.css">
  <script src="auth-helper.js"></script>
  <style>
    /* –õ–æ–∫–∞–ª—å–Ω—ã–µ —Å—Ç–∏–ª–∏ –¥–ª—è –∞–∫–∫—É—Ä–∞—Ç–Ω–æ–≥–æ –≤–∏–¥–∞ –±–µ–∑ –ø–æ–¥—á–µ—Ä–∫–∏–≤–∞–Ω–∏–π */
    .sidebar ul {
      list-style: none;
      padding: 0;
      margin-top: 1rem;
    }
    .sidebar ul li {
      margin-bottom: 12px;
    }
    .sidebar ul li a {
      text-decoration: none !important; /* –£–±–∏—Ä–∞–µ–º –ø–æ–¥—á–µ—Ä–∫–∏–≤–∞–Ω–∏–µ */
      color: #2c3e50;
      font-weight: 500;
      transition: 0.3s;
      display: block;
    }
    .sidebar ul li a:hover {
      color: #e74c3c;
      transform: translateX(5px);
    }
    .sidebar h3 {
      font-size: 1.2rem;
      text-transform: uppercase;
      border-bottom: 2px solid #e74c3c;
      padding-bottom: 8px;
      margin-bottom: 1rem;
    }
    .price-inputs {
      display: flex;
      flex-direction: column;
      gap: 10px;
      margin-bottom: 15px;
    }
    .price-inputs input {
      padding: 8px;
      border: 1px solid #ddd;
      border-radius: 4px;
      font-family: 'Montserrat', sans-serif;
    }
  </style>
</head>
<body>

<header>
  <div class="container">
    <div class="header-top">
      <div class="logo"><a href="index.html" style="text-decoration: none; color: inherit;">–°–¢–†–û–ô–ú–ê–ì</a></div>
      <div class="search-bar">
        <input type="text" id="catalog-search" placeholder="–ü–æ–∏—Å–∫ —Ç–æ–≤–∞—Ä–æ–≤...">
      </div>
      <div class="header-actions">
        <a href="cart.html" class="cart">–ö–æ—Ä–∑–∏–Ω–∞ (3)</a>
        <a href="login.html" class="login">–í–æ–π—Ç–∏</a>
      </div>
    </div>
    <nav>
      <ul class="nav-menu">
        <li><a href="index.html">–ì–õ–ê–í–ù–ê–Ø</a></li>
        <li><a href="catalog.html" class="active">–ö–ê–¢–ê–õ–û–ì</a></li>
        <li><a href="promotions.html">–ê–ö–¶–ò–ò</a></li>
        <li><a href="delivery.html">–î–û–°–¢–ê–í–ö–ê</a></li>
        <li><a href="contacts.html">–ö–û–ù–¢–ê–ö–¢–´</a></li>
      </ul>
    </nav>
  </div>
</header>

<main class="container">
  <div class="catalog-layout" style="display: grid; grid-template-columns: 250px 1fr; gap: 30px; margin-top: 40px; align-items: start;">

    <aside class="sidebar" style="background: white; padding: 20px; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.05);">
      <h3>–ö–∞—Ç–µ–≥–æ—Ä–∏–∏</h3>
      <ul>
        <li><a href="#" onclick="filterBy('category', 'all')">–í—Å–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏</a></li>
        <li><a href="#" onclick="filterBy('category', '–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã')">–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã</a></li>
        <li><a href="#" onclick="filterBy('category', '–°—Ç—Ä–æ–π–º–∞—Ç–µ—Ä–∏–∞–ª—ã')">–°—Ç—Ä–æ–π–º–∞—Ç–µ—Ä–∏–∞–ª—ã</a></li>
        <li><a href="#" onclick="filterBy('category', '–°–∞–Ω—Ç–µ—Ö–Ω–∏–∫–∞')">–°–∞–Ω—Ç–µ—Ö–Ω–∏–∫–∞</a></li>
        <li><a href="#" onclick="filterBy('category', '–≠–ª–µ–∫—Ç—Ä–∏–∫–∞')">–≠–ª–µ–∫—Ç—Ä–∏–∫–∞</a></li>
      </ul>

      <h3 style="margin-top: 30px;">–¶–µ–Ω–∞, ‚ÇΩ</h3>
      <div class="price-inputs">
        <input type="number" id="price-min" placeholder="–û—Ç">
        <input type="number" id="price-max" placeholder="–î–æ">
      </div>
      <button class="add-to-cart" onclick="filterBy('price')" style="font-size: 0.8rem; padding: 10px;">–ü—Ä–∏–º–µ–Ω–∏—Ç—å</button>
    </aside>

    <section class="products-area">
      <h1 class="section-title" style="text-align: left; margin-bottom: 25px;">–ö–∞—Ç–∞–ª–æ–≥ –ø—Ä–æ–¥—É–∫—Ü–∏–∏</h1>
      <div class="products-grid" id="products-container">
      </div>
    </section>
  </div>
</main>

<footer>
  <div class="container">
    <div class="footer-bottom">
      <p>¬© 2025 –°—Ç—Ä–æ–π–ú–∞–≥. –í—Å–µ –ø—Ä–∞–≤–∞ –∑–∞—â–∏—â–µ–Ω—ã.</p>
    </div>
  </div>
</footer>

<script>
  let allProducts = [];

  async function loadProducts() {
    try {
      const response = await fetch('/api/products');
      allProducts = await response.json();
      renderProducts(allProducts);
    } catch (err) {
      console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏:', err);
    }
  }

  function renderProducts(items) {
    const container = document.getElementById('products-container');
    container.innerHTML = '';
    items.forEach(product => {
      console.log(product);
      const card = document.createElement('div');
      card.className = 'product-card';
      card.innerHTML = `
                <div class="product-image">üì¶</div>
                <div class="product-info">
                    <p style="font-size: 0.7rem; color: #999;">${product.category || '–û–±—â–µ–µ'}</p>
                    <h3 style="margin: 5px 0 10px 0; font-size: 1rem;">${product.name}</h3>
                    <div class="product-price">${Number(product.price).toLocaleString()} —Ä.</div>
                    <button class="add-to-cart">–í –ö–û–†–ó–ò–ù–£</button>
                </div>
            `;
      container.appendChild(card);
    });
  }

  function filterBy(type, value) {
    let filtered = allProducts;

    if (type === 'category') {
      if (value !== 'all') {
        filtered = allProducts.filter(p => p.category === value);
      }
    } else if (type === 'price') {
      const min = parseFloat(document.getElementById('price-min').value) || 0;
      const max = parseFloat(document.getElementById('price-max').value) || Infinity;
      filtered = allProducts.filter(p => p.price >= min && p.price <= max);
    }

    renderProducts(filtered);
  }

  document.getElementById('catalog-search').addEventListener('input', (e) => {
    const term = e.target.value.toLowerCase();
    const filtered = allProducts.filter(p => p.name.toLowerCase().includes(term));
    renderProducts(filtered);
  });

  document.addEventListener('DOMContentLoaded', loadProducts);
</script>

</body>
</html>